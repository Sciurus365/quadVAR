<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Using the glmnet and ncvreg packages, fits a Generalized Linear Model or Cox Proportional Hazards Model using various methods for choosing the regularization parameter \(\lambda\) — tune.fit • quadVAR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the glmnet and ncvreg packages, fits a Generalized Linear Model or Cox Proportional Hazards Model using various methods for choosing the regularization parameter \(\lambda\) — tune.fit"><meta name="description" content="This function is modified from SIS::tune.fit(). It is used to tune the regularization parameter for the regularized VAR models. This wrapper is used because of the following reasons.
The original SIS::tune.fit() function does not return the value of the information criteria that we would like to use.
We use the ncvreg package exclusively (so we removed the code using the glmnet package). This is to make the result more consistent, and also because the ncvreg package has better support for the calculation of information criteria.
We also removed the generalized linear model (GLM) option, and the cross-validation option because we do not use them.
We use stats::AIC() and stats::BIC() instead of the ones using SIS:::loglik() to make the calculation methods more consistent.
We added ... to allow the user to pass additional arguments to the ncvreg::ncvreg() function.

"><meta property="og:description" content="This function is modified from SIS::tune.fit(). It is used to tune the regularization parameter for the regularized VAR models. This wrapper is used because of the following reasons.
The original SIS::tune.fit() function does not return the value of the information criteria that we would like to use.
We use the ncvreg package exclusively (so we removed the code using the glmnet package). This is to make the result more consistent, and also because the ncvreg package has better support for the calculation of information criteria.
We also removed the generalized linear model (GLM) option, and the cross-validation option because we do not use them.
We use stats::AIC() and stats::BIC() instead of the ones using SIS:::loglik() to make the calculation methods more consistent.
We added ... to allow the user to pass additional arguments to the ncvreg::ncvreg() function.

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">quadVAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Sciurus365/quadVAR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using the <strong>glmnet</strong> and <strong>ncvreg</strong> packages, fits a Generalized Linear Model or Cox Proportional Hazards Model using various methods for choosing the regularization parameter \(\lambda\)</h1>
      <small class="dont-index">Source: <a href="https://github.com/Sciurus365/quadVAR/blob/master/R/SIS-tune.fit.R" class="external-link"><code>R/SIS-tune.fit.R</code></a></small>
      <div class="d-none name"><code>tune.fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is modified from <code><a href="https://rdrr.io/pkg/SIS/man/tune.fit.html" class="external-link">SIS::tune.fit()</a></code>. It is used to tune the regularization parameter for the regularized VAR models. This wrapper is used because of the following reasons.</p><ol><li><p>The original <code><a href="https://rdrr.io/pkg/SIS/man/tune.fit.html" class="external-link">SIS::tune.fit()</a></code> function does not return the value of the information criteria that we would like to use.</p></li>
<li><p>We use the ncvreg package exclusively (so we removed the code using the glmnet package). This is to make the result more consistent, and also because the ncvreg package has better support for the calculation of information criteria.</p></li>
<li><p>We also removed the generalized linear model (GLM) option, and the cross-validation option because we do not use them.</p></li>
<li><p>We use stats::AIC() and stats::BIC() instead of the ones using SIS:::loglik() to make the calculation methods more consistent.</p></li>
<li><p>We added <code>...</code> to allow the user to pass additional arguments to the ncvreg::ncvreg() function.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tune.fit</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SCAD"</span>, <span class="st">"MCP"</span>, <span class="st">"lasso"</span><span class="op">)</span>,</span>
<span>  concavity.parameter <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">penalty</span>, SCAD <span class="op">=</span> <span class="fl">3.7</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  tune <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aic"</span>, <span class="st">"bic"</span>, <span class="st">"ebic"</span><span class="op">)</span>,</span>
<span>  type.measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"class"</span>, <span class="st">"auc"</span>, <span class="st">"mse"</span>, <span class="st">"mae"</span><span class="op">)</span>,</span>
<span>  gamma.ebic <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The design matrix, of dimensions n * p, without an intercept. Each
row is an observation vector.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The response vector of dimension n * 1. Quantitative for
<code>family='gaussian'</code>, non-negative counts for <code>family='poisson'</code>,
binary (0-1) for <code>family='binomial'</code>. For <code>family='cox'</code>, <code>y</code>
should be an object of class <code>Surv</code>, as provided by the function
<code>Surv()</code> in the package <span class="pkg">survival</span>.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Response type (see above).</p></dd>


<dt id="arg-penalty">penalty<a class="anchor" aria-label="anchor" href="#arg-penalty"></a></dt>
<dd><p>The penalty to be applied in the regularized likelihood
subproblems. 'SCAD' (the default), 'MCP', or 'lasso' are provided.</p></dd>


<dt id="arg-concavity-parameter">concavity.parameter<a class="anchor" aria-label="anchor" href="#arg-concavity-parameter"></a></dt>
<dd><p>The tuning parameter used to adjust the concavity
of the SCAD/MCP penalty. Default is 3.7 for SCAD and 3 for MCP.</p></dd>


<dt id="arg-tune">tune<a class="anchor" aria-label="anchor" href="#arg-tune"></a></dt>
<dd><p>Method for selecting the regularization parameter along the
solution path of the penalized likelihood problem. Options to provide a
final model include <code>tune='cv'</code>, <code>tune='aic'</code>, <code>tune='bic'</code>,
and <code>tune='ebic'</code>. See references at the end for details.</p></dd>


<dt id="arg-type-measure">type.measure<a class="anchor" aria-label="anchor" href="#arg-type-measure"></a></dt>
<dd><p>Loss to use for cross-validation. Currently five
options, not all available for all models. The default is
<code>type.measure='deviance'</code>, which uses squared-error for gaussian models
(also equivalent to <code>type.measure='mse'</code> in this case), deviance for
logistic and poisson regression, and partial-likelihood for the Cox model.
Both <code>type.measure='class'</code> and <code>type.measure='auc'</code> apply only to
logistic regression and give misclassification error and area under the ROC
curve, respectively. <code>type.measure='mse'</code> or <code>type.measure='mae'</code>
(mean absolute error) can be used by all models except the <code>'cox'</code>;
they measure the deviation from the fitted mean to the response. For
<code>penalty='SCAD'</code> and <code>penalty='MCP'</code>, only
<code>type.measure='deviance'</code> is available.</p></dd>


<dt id="arg-gamma-ebic">gamma.ebic<a class="anchor" aria-label="anchor" href="#arg-gamma-ebic"></a></dt>
<dd><p>Specifies the parameter in the Extended BIC criterion
penalizing the size of the corresponding model space. The default is
<code>gamma.ebic=1</code>. See references at the end for details.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to be passed to the ncvreg::ncvreg() function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object with</p>
<dl><dt>ix</dt>
<dd><p>The vector of indices of the
nonzero coefficients selected by the maximum penalized likelihood procedure
with <code>tune</code> as the method for choosing the regularization parameter.</p></dd>

<dt>a0</dt>
<dd><p>The intercept of the final model selected by <code>tune</code>.</p></dd>

<dt>beta</dt>
<dd><p>The vector of coefficients of the final model selected by
<code>tune</code>.</p></dd>

<dt>fit</dt>
<dd><p>The fitted penalized regression object.</p></dd>

<dt>lambda</dt>
<dd><p>The corresponding lambda in the final model.</p></dd>

<dt>lambda.ind</dt>
<dd><p>The index on the solution path for the final model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Original description from <code><a href="https://rdrr.io/pkg/SIS/man/tune.fit.html" class="external-link">SIS::tune.fit()</a></code>:</p>
<p>This function fits a generalized linear model or a Cox proportional hazards model via penalized maximum likelihood, with available penalties as indicated in the <strong>glmnet</strong> and <strong>ncvreg</strong> packages. Instead of providing the whole regularization solution path, the function returns the solution at a unique value of \(\lambda\), the one optimizing the criterion specified in tune.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jerome Friedman and Trevor Hastie and Rob Tibshirani (2010)
Regularization Paths for Generalized Linear Models Via Coordinate Descent.
<em>Journal of Statistical Software</em>, <b>33</b>(1), 1-22.</p>
<p>Noah Simon and Jerome Friedman and Trevor Hastie and Rob Tibshirani (2011)
Regularization Paths for Cox's Proportional Hazards Model Via Coordinate
Descent. <em>Journal of Statistical Software</em>, <b>39</b>(5), 1-13.</p>
<p>Patrick Breheny and Jian Huang (2011) Coordiante Descent Algorithms for
Nonconvex Penalized Regression, with Applications to Biological Feature
Selection. <em>The Annals of Applied Statistics</em>, <b>5</b>, 232-253.</p>
<p>Hirotogu Akaike (1973) Information Theory and an Extension of the Maximum
Likelihood Principle. In <em>Proceedings of the 2nd International
Symposium on Information Theory</em>, BN Petrov and F Csaki (eds.), 267-281.</p>
<p>Gideon Schwarz (1978) Estimating the Dimension of a Model. <em>The Annals
of Statistics</em>, <b>6</b>, 461-464.</p>
<p>Jiahua Chen and Zehua Chen (2008) Extended Bayesian Information Criteria for
Model Selection with Large Model Spaces. <em>Biometrika</em>, <b>95</b>,
759-771.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jianqing Fan, Yang Feng, Diego Franco Saldana, Richard Samworth, and
Yichao Wu</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"leukemia.train"</span>, package <span class="op">=</span> <span class="st">"SIS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y.train</span> <span class="op">&lt;-</span> <span class="va">leukemia.train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">leukemia.train</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">x.train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">leukemia.train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">leukemia.train</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x.train</span> <span class="op">&lt;-</span> <span class="fu">SIS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SIS/man/standardize.html" class="external-link">standardize</a></span><span class="op">(</span><span class="va">x.train</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">tune.fit</span><span class="op">(</span><span class="va">x.train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3500</span><span class="op">]</span>, <span class="va">y.train</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, tune <span class="op">=</span> <span class="st">"bic"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Maximum number of iterations reached</span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">ix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  V461 V2020 V3320 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   461  2020  3320 </span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">a0</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -1.00974 </span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     V461    V2020    V3320 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.411225 2.356301 2.615023 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jingmeng Cui.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

