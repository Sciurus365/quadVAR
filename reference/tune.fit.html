<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function is modified from SIS::tune.fit(). It is used to tune the regularization parameter for the regularized VAR models. This wrapper is used because of the following reasons.
The original SIS::tune.fit() function does not return the value of the information criteria that we would like to use.
We use the ncvreg package exclusively (so we removed the code using the glmnet package). This is to make the result more consistent, and also because the ncvreg package has better support for the calculation of information criteria.
We also removed the generalized linear model (GLM) option, and the cross-validation option because we do not use them.
We use stats::AIC() and stats::BIC() instead of the ones using SIS:::loglik() to make the calculation methods more consistent.
We added ... to allow the user to pass additional arguments to the ncvreg::ncvreg() function.

"><title>Using the glmnet and ncvreg packages, fits a Generalized Linear Model or Cox Proportional Hazards Model using various methods for choosing the regularization parameter λ — tune.fit • quadVAR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the glmnet and ncvreg packages, fits a Generalized Linear Model or Cox Proportional Hazards Model using various methods for choosing the regularization parameter λ — tune.fit"><meta property="og:description" content="This function is modified from SIS::tune.fit(). It is used to tune the regularization parameter for the regularized VAR models. This wrapper is used because of the following reasons.
The original SIS::tune.fit() function does not return the value of the information criteria that we would like to use.
We use the ncvreg package exclusively (so we removed the code using the glmnet package). This is to make the result more consistent, and also because the ncvreg package has better support for the calculation of information criteria.
We also removed the generalized linear model (GLM) option, and the cross-validation option because we do not use them.
We use stats::AIC() and stats::BIC() instead of the ones using SIS:::loglik() to make the calculation methods more consistent.
We added ... to allow the user to pass additional arguments to the ncvreg::ncvreg() function.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">quadVAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Sciurus365/quadVAR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using the <strong>glmnet</strong> and <strong>ncvreg</strong> packages, fits a Generalized Linear Model or Cox Proportional Hazards Model using various methods for choosing the regularization parameter λ</h1>
      <small class="dont-index">Source: <a href="https://github.com/Sciurus365/quadVAR/blob/HEAD/R/SIS-tune.fit.R" class="external-link"><code>R/SIS-tune.fit.R</code></a></small>
      <div class="d-none name"><code>tune.fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is modified from <code><a href="https://rdrr.io/pkg/SIS/man/tune.fit.html" class="external-link">SIS::tune.fit()</a></code>. It is used to tune the regularization parameter for the regularized VAR models. This wrapper is used because of the following reasons.</p><ol><li><p>The original <code><a href="https://rdrr.io/pkg/SIS/man/tune.fit.html" class="external-link">SIS::tune.fit()</a></code> function does not return the value of the information criteria that we would like to use.</p></li>
<li><p>We use the ncvreg package exclusively (so we removed the code using the glmnet package). This is to make the result more consistent, and also because the ncvreg package has better support for the calculation of information criteria.</p></li>
<li><p>We also removed the generalized linear model (GLM) option, and the cross-validation option because we do not use them.</p></li>
<li><p>We use stats::AIC() and stats::BIC() instead of the ones using SIS:::loglik() to make the calculation methods more consistent.</p></li>
<li><p>We added <code>...</code> to allow the user to pass additional arguments to the ncvreg::ncvreg() function.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tune.fit</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SCAD"</span>, <span class="st">"MCP"</span>, <span class="st">"lasso"</span><span class="op">)</span>,</span>
<span>  concavity.parameter <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">penalty</span>, SCAD <span class="op">=</span> <span class="fl">3.7</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  tune <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aic"</span>, <span class="st">"bic"</span>, <span class="st">"ebic"</span><span class="op">)</span>,</span>
<span>  type.measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"class"</span>, <span class="st">"auc"</span>, <span class="st">"mse"</span>, <span class="st">"mae"</span><span class="op">)</span>,</span>
<span>  gamma.ebic <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>The design matrix, of dimensions n * p, without an intercept. Each
row is an observation vector.</p></dd>


<dt>y</dt>
<dd><p>The response vector of dimension n * 1. Quantitative for
<code>family='gaussian'</code>, non-negative counts for <code>family='poisson'</code>,
binary (0-1) for <code>family='binomial'</code>. For <code>family='cox'</code>, <code>y</code>
should be an object of class <code>Surv</code>, as provided by the function
<code>Surv()</code> in the package <span class="pkg">survival</span>.</p></dd>


<dt>family</dt>
<dd><p>Response type (see above).</p></dd>


<dt>penalty</dt>
<dd><p>The penalty to be applied in the regularized likelihood
subproblems. 'SCAD' (the default), 'MCP', or 'lasso' are provided.</p></dd>


<dt>concavity.parameter</dt>
<dd><p>The tuning parameter used to adjust the concavity
of the SCAD/MCP penalty. Default is 3.7 for SCAD and 3 for MCP.</p></dd>


<dt>tune</dt>
<dd><p>Method for selecting the regularization parameter along the
solution path of the penalized likelihood problem. Options to provide a
final model include <code>tune='cv'</code>, <code>tune='aic'</code>, <code>tune='bic'</code>,
and <code>tune='ebic'</code>. See references at the end for details.</p></dd>


<dt>type.measure</dt>
<dd><p>Loss to use for cross-validation. Currently five
options, not all available for all models. The default is
<code>type.measure='deviance'</code>, which uses squared-error for gaussian models
(also equivalent to <code>type.measure='mse'</code> in this case), deviance for
logistic and poisson regression, and partial-likelihood for the Cox model.
Both <code>type.measure='class'</code> and <code>type.measure='auc'</code> apply only to
logistic regression and give misclassification error and area under the ROC
curve, respectively. <code>type.measure='mse'</code> or <code>type.measure='mae'</code>
(mean absolute error) can be used by all models except the <code>'cox'</code>;
they measure the deviation from the fitted mean to the response. For
<code>penalty='SCAD'</code> and <code>penalty='MCP'</code>, only
<code>type.measure='deviance'</code> is available.</p></dd>


<dt>gamma.ebic</dt>
<dd><p>Specifies the parameter in the Extended BIC criterion
penalizing the size of the corresponding model space. The default is
<code>gamma.ebic=1</code>. See references at the end for details.</p></dd>


<dt>...</dt>
<dd><p>additional arguments to be passed to the ncvreg::ncvreg() function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns an object with</p>
<dl><dt>ix</dt>
<dd><p>The vector of indices of the
nonzero coefficients selected by the maximum penalized likelihood procedure
with <code>tune</code> as the method for choosing the regularization parameter.</p></dd>

<dt>a0</dt>
<dd><p>The intercept of the final model selected by <code>tune</code>.</p></dd>

<dt>beta</dt>
<dd><p>The vector of coefficients of the final model selected by
<code>tune</code>.</p></dd>

<dt>fit</dt>
<dd><p>The fitted penalized regression object.</p></dd>

<dt>lambda</dt>
<dd><p>The corresponding lambda in the final model.</p></dd>

<dt>lambda.ind</dt>
<dd><p>The index on the solution path for the final model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Original description from <code><a href="https://rdrr.io/pkg/SIS/man/tune.fit.html" class="external-link">SIS::tune.fit()</a></code>:</p>
<p>This function fits a generalized linear model or a Cox proportional hazards model via penalized maximum likelihood, with available penalties as indicated in the <strong>glmnet</strong> and <strong>ncvreg</strong> packages. Instead of providing the whole regularization solution path, the function returns the solution at a unique value of λ, the one optimizing the criterion specified in tune.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jerome Friedman and Trevor Hastie and Rob Tibshirani (2010)
Regularization Paths for Generalized Linear Models Via Coordinate Descent.
<em>Journal of Statistical Software</em>, <b>33</b>(1), 1-22.</p>
<p>Noah Simon and Jerome Friedman and Trevor Hastie and Rob Tibshirani (2011)
Regularization Paths for Cox's Proportional Hazards Model Via Coordinate
Descent. <em>Journal of Statistical Software</em>, <b>39</b>(5), 1-13.</p>
<p>Patrick Breheny and Jian Huang (2011) Coordiante Descent Algorithms for
Nonconvex Penalized Regression, with Applications to Biological Feature
Selection. <em>The Annals of Applied Statistics</em>, <b>5</b>, 232-253.</p>
<p>Hirotogu Akaike (1973) Information Theory and an Extension of the Maximum
Likelihood Principle. In <em>Proceedings of the 2nd International
Symposium on Information Theory</em>, BN Petrov and F Csaki (eds.), 267-281.</p>
<p>Gideon Schwarz (1978) Estimating the Dimension of a Model. <em>The Annals
of Statistics</em>, <b>6</b>, 461-464.</p>
<p>Jiahua Chen and Zehua Chen (2008) Extended Bayesian Information Criteria for
Model Selection with Large Model Spaces. <em>Biometrika</em>, <b>95</b>,
759-771.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jianqing Fan, Yang Feng, Diego Franco Saldana, Richard Samworth, and
Yichao Wu</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"leukemia.train"</span>, package <span class="op">=</span> <span class="st">"SIS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y.train</span> <span class="op">&lt;-</span> <span class="va">leukemia.train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">leukemia.train</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">x.train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">leukemia.train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">leukemia.train</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x.train</span> <span class="op">&lt;-</span> <span class="fu">standardize</span><span class="op">(</span><span class="va">x.train</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">tune.fit</span><span class="op">(</span><span class="va">x.train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3500</span><span class="op">]</span>, <span class="va">y.train</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, tune <span class="op">=</span> <span class="st">"bic"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">ix</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">a0</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jingmeng Cui.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

